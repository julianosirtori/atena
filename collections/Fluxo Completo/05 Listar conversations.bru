meta {
  name: 05 — Listar conversations
  type: http
  seq: 5
}

get {
  url: {{baseUrl}}/api/v1/tenants/{{tenantId}}/conversations?page=1&limit=20
  body: none
  auth: none
}

params:query {
  page: 1
  limit: 20
}

script:post-response {
  const body = res.getBody();
  if (body && body.data && body.data.length > 0) {
    bru.setEnvVar("testConversationId", body.data[0].id);
  }
}

tests {
  test("status code é 200", function() {
    expect(res.getStatus()).to.equal(200);
  });

  test("data é um array com pelo menos 1 conversa", function() {
    const body = res.getBody();
    expect(body.data).to.be.an("array");
    expect(body.data.length).to.be.greaterThan(0);
  });

  test("testConversationId salvo no ambiente", function() {
    const body = res.getBody();
    expect(body.data[0].id).to.be.a("string");
  });
}

docs {
  # Fluxo Completo — 05 Listar conversations

  **Passo 5/9** — Lista as conversas do tenant e salva `testConversationId`.
}
